<ion-header>
    <ion-navbar>
        <ion-title>
            创建底稿
        </ion-title>
    </ion-navbar>
</ion-header>
<ion-content>
    <form [formGroup]="detaWork" (ngSubmit)="onSubmit(detaWork)" *ngIf="_isfinsh">
        <ion-list class=" lists_input">
            <button ion-item class="num" type="button">
                <span class="title_span">被检查企业:</span>
                <!--<ion-input type="number"  [formControl]="Workfrom.enterprise"></ion-input>-->
                <span>{{plibraryName}}</span>
                <button ion-button icon-only item-end clear color="light" type="button" class="no_button">
                    <ion-icon  name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <!--<button ion-item class="num " type="button">
                <ion-label ><span class="title_span">检查时点:</span></ion-label>
                <ion-datetime min="1981" cancelText="取消" doneText="选择" displayFormat="YYYY/DD/MM" [formControl]="Workfrom.checkedTime"></ion-datetime>
                <button ion-button icon-only item-end clear color="light" type="button" class="no_button">
                    <ion-icon  name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>-->
            <button ion-item class="num " type="button">
                <ion-label class="title_span"><span class="title_span">实际查库日:</span></ion-label>
                <!--<ion-datetime min="1981" cancelText="取消" doneText="选择" displayFormat="YYYY/DD/MM" pickerFormat="YYYY MM DD" [formControl]="Workfrom.realCheckedTime" [(ngModel)]="dateTime"></ion-datetime>-->
                
                 <ion-datetime min="1981" cancelText="取消" doneText="选择"  pickerFormat="YYYY MM DD" displayFormat="YYYY-MM-DD"  [formControl]="Workfrom.realCheckedTime" [(ngModel)]="dateTime"></ion-datetime>
                <button ion-button icon-only item-end clear color="light" type="button" class="no_button">
                    <ion-icon  name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
        </ion-list>
        <ion-list>
            <button type="button" ion-item class="num ">
                <span class="title_span">货位号:</span>
                <!--<ion-input type="number" [formControl]="Workfrom.enterprise"></ion-input>-->
                <span>{{data.position}}</span>
                 <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" class="num " ion-item>
                <span class="title_span">品种:</span>
                 <!--<ion-input type="number" [formControl]="Workfrom.sort"></ion-input>-->
                <span>{{data.sort}}</span>
                <button ion-button icon-only item-end clear color="light" type="button" class="no_button">
                    <ion-icon  name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num ">
                <span class="title_span">性质:</span>
                <span>{{data.quality}}</span>
                 <!--<ion-input type="number" [formControl]="Workfrom.quality"></ion-input>-->
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num ">
                <span class="title_span">所在库区:</span>
                <span >{{data.libraryName}}</span>
                 <!--<ion-input type="number" [formControl]="Workfrom.libraryName"></ion-input>-->
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num " (click)="barnType()">
                <ion-label class="title_span">仓库类型:</ion-label>
                <ion-input type="text" [formControl]="Workfrom.barnType" readonly="true"   [value]="detaWork.value.barnType"></ion-input>
                <!--<span>{{detaWork.value.barnType}}</span>-->
                <!--<button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>-->
            </button>
            <button type="button" ion-item class="num ">
                <span class="title_span">收获年度:</span>
                <!--<ion-datetime min="1981" cancelText="取消" doneText="选择"  displayFormat="YYYY" [formControl]="Workfrom.gainTime"></ion-datetime>-->
                <span>{{data.gainTime}}</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num num_kg">
                <span class="title_span">保管帐数量(kg):</span>
                <span>{{data.amount}}</span>
                <!--<ion-input type="number" [formControl]="Workfrom.grainQuality" [value]="data.amount" (keyup)="bgzrsh($event)"></ion-input>-->
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num " (click)="putWay()">
                <ion-label class="title_span">入仓方式:</ion-label>
                
                <ion-label class="float_label" [ngSwitch]="Work.putWay">
                    <ion-input type="text" *ngSwitchCase="1" readonly="true" value="机械入仓" [formControl]="Workfrom.putWay"></ion-input>
                    <ion-input type="text" *ngSwitchCase="2" readonly="true" value="人工入仓" [formControl]="Workfrom.putWay"></ion-input>
                    <ion-input type="text" *ngSwitchDefault readonly="true" value="" [formControl]="Workfrom.putWay"></ion-input>
                </ion-label>
                <!--<span>{{_putWay}}</span>-->
                <!--<button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>-->
            </button>
        </ion-list>
        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">粮食入库质量:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num first_item no_border" (click)="qualityGrade()">
                <ion-label class="title_span">质量等级:</ion-label>
                 <ion-label class="float_label" [ngSwitch]="Work.qualityGrade">
                    <ion-input type="text" *ngSwitchCase="1" readonly="true"   value="一等" [formControl]="Workfrom.qualityGrade" >一等</ion-input>
                    <ion-input type="text" *ngSwitchCase="2" readonly="true"   value="二等" [formControl]="Workfrom.qualityGrade" >二等</ion-input>
                    <ion-input type="text" *ngSwitchCase="3" readonly="true"   value="三等" [formControl]="Workfrom.qualityGrade" >三等</ion-input>  
                    <ion-input type="text" *ngSwitchDefault [formControl]="Workfrom.qualityGrade"  readonly="true" [value]=""></ion-input>              
                </ion-label>
                 
                <!--<button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>-->
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">容重（g/l）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.storageCapacity"  [value]="detaWork.value.storageCapacity"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">水分（%）:</ion-label>
                 <ion-input type="number"  [formControl]="Workfrom.storageWater" [value]="detaWork.value.storageWater"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">杂质（%）:</ion-label>
                 <ion-input type="number"  [formControl]="Workfrom.storageImpurity" [value]="detaWork.value.storageImpurity"></ion-input>
            </button>
        </ion-list>
        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">实测入库质量:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num first_item no_border">
                <ion-label class="title_span">容重（g/l）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.realCapacity" [value]="detaWork.value.realCapacity" (keyup)="rongzhong($event)" (keydown)="ldpjmd($event)"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">水分（%）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.realWater" [value]="detaWork.value.realWater"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">杂质（%）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.realImpurity"  [value]="detaWork.value.realImpurity"></ion-input>
            </button>
        </ion-list>
        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">粮堆形状及基本尺寸:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <ion-item class="list_img">
                <img src="assets/image/index/work.png"/>
            </ion-item>
            <button type="button" ion-item class="num first_item no_border">
                <ion-label class="title_span">长（m）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.length" [value]="detaWork.value.length" (keyup)="mianji($event)"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">宽（m）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.wide" [value]="detaWork.value.wide" (keyup)="mianji($event)"></ion-input>
            </button>
            <button type="button" ion-item class="num ">
                <ion-label class="title_span">高（m）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.high" [value]="detaWork.value.high" (keyup)="mianji($event)"></ion-input>
            </button>
        </ion-list>
        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input ">
                <span class="title_span title_span_font">1.计算粮堆体积:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num first_item no_border long_item">
                <ion-label class="title_span">粮堆测量体积（m3）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.measuredVolume" [value]="detaWork.value.measuredVolume" readonly="true"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">需要扣除体积（m3）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.deductVolume" [value]="detaWork.value.deductVolume" (keyup)="sttj($event)"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">粮堆实体体积（m3）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.realVolume" [value]="detaWork.value.realVolume" readonly="true"></ion-input>
            </button>
        </ion-list>
        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">2.计算粮堆平均密度:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="no_border first_item first_item_font">
                <ion-label>标准容重器法√</ion-label>
                 <!--<ion-input type="number"></ion-input>-->
            </button>
            <button type="button" ion-item class="num  data long_item">
                <ion-label class="title_span">粮食容重（g/l）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.realCapacity" [value]="detaWork.value.realCapacity" readonly="true"></ion-input>
            </button>
            <button type="button" ion-item class="num data long_item">
                <ion-label class="title_span">校正后修正系数:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.correctioFactor" [value]="detaWork.value.correctioFactor" (keyup)="ldpjmd($event)"></ion-input>
            </button>
            <button type="button" ion-item class="num data long_item" (keydown)="unQuality()">
                <ion-label class="title_span">粮堆平均密度（kg/m）:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.aveDensity" [value]="detaWork.value.aveDensity"></ion-input>
            </button>
            <!--<button type="button" ion-item class="no_border first_item first_item_font">
                <ion-label>特制大容器法□</ion-label>
                 <ion-input type="number"></ion-input>
            </button>
            <button type="button" ion-item class="num first_item no_border long_item">
                <ion-label class="title_span">单位体积粮食重量(kg/m):</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.unit_volume_weight_tz"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">校正后修正系数:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.correction_factor_tz"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">粮堆平均密度(kg/m):</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.average_density_tz"></ion-input>
            </button>-->
        </ion-list>

        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">3.计算粮食数量:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num  data long_item no_border first_item">
                <ion-label class="title_span">测量计算数(kg):</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.unQuality" [value]="detaWork.value.realVolume * detaWork.value.aveDensity" readonly="true"></ion-input>
            </button>
            <button type="button" ion-item class="no_border first_item first_item_font">
                <ion-label>应记粮食损耗(kg)</ion-label>
                 <!--<ion-input type="number"></ion-input>-->
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">水分减量:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.lossWater"  [value]="detaWork.value.lossWater" ></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">保管自然损耗:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.lossNature" [value]="detaWork.value.lossNature"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">合计:</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.loss" [value]="detaWork.value.lossWater + detaWork.value.lossNature" readonly="true"></ion-input>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">检查计算数(kg):</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.checkNum" [value]="detaWork.value.unQuality + detaWork.value.loss" readonly="true"></ion-input>
            </button>
        </ion-list>

        <ion-list class="lists_input">
            <button type="button" ion-item class="list_input">
                <span class="title_span title_span_font">4.认定粮食实际数量:</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="no_border first_item first_item_font">
                <ion-label>检查计算数与保管账数量比较</ion-label>
                 <!--<ion-input type="number"></ion-input>-->
            </button>
            <button type="button" ion-item class="num  data long_item">
                <ion-label class="title_span">差数(kg):</ion-label>
                 <ion-input type="number" [formControl]="Workfrom.difference" [value]="data.amount - detaWork.value.checkNum"></ion-input>
            </button>
            <button type="button" ion-item class="num data long_item">
                <ion-label class="title_span">差率(%):</ion-label>
                 <ion-input type="number"   [formControl]="Workfrom.slip" [value]="detaWork.value.difference/data.amount"></ion-input>
            </button>
            <button type="button" ion-item class="num data long_item" (click)="slip()">
                <ion-label class="title_span">账实是否相符:</ion-label>
                 <ion-input type="text"   [formControl]="Workfrom.isMatch"  readonly="true" [value]="detaWork.value.isMatch"></ion-input>
                <!--<span >{{_slip}}</span>-->
                <!--<button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>-->
            </button>
            <button type="button" ion-item class="num long_item">
                <span class="title_span">粮食实际数量(kg):</span>
                <span>{{data.amount}}</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            </button>
            <button type="button" ion-item class="num long_item">
                <ion-label class="title_span">账实不符原因:</ion-label>
                 <ion-input type="text" [formControl]="Workfrom.result" [value]="detaWork.value.result"></ion-input>
            </button>
        </ion-list>
        <ion-list>
            <button type="button" ion-item class="num text_left">
                <span class="title_span">备注:</span>
                <span>{{data.remark}}</span>
                <button ion-button icon-only item-end clear color="light" class="no_button">
                    <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
            <!--<ion-input type="number"  [formControl]="Workfrom.remark"></ion-input>-->
            </button>
        </ion-list>
        <button ion-button large color="secondary" class="sumbit" type="submit" [disabled]="!(detaWork.valid)">提交</button>
    </form>
</ion-content>